[gd_scene load_steps=39 format=3 uid="uid://dep3tqdr7m3mv"]

[ext_resource type="Texture2D" uid="uid://jubqmr80omsx" path="res://sprites/kirby.png" id="2_1rp8d"]
[ext_resource type="TileSet" uid="uid://bfccyc4tus0bl" path="res://tiles/green_greens.tres" id="2_ytr8y"]
[ext_resource type="Texture2D" uid="uid://cd1vp7m1u6u4i" path="res://sprites/small_star.png" id="3_p0u2b"]

[sub_resource type="Animation" id="Animation_2auoa"]
resource_name = "crouch"
tracks/0/type = "value"
tracks/0/imported = false
tracks/0/enabled = true
tracks/0/path = NodePath(".:frame")
tracks/0/interp = 1
tracks/0/loop_wrap = true
tracks/0/keys = {
"times": PackedFloat32Array(0),
"transitions": PackedFloat32Array(1),
"update": 1,
"values": [1]
}

[sub_resource type="Animation" id="Animation_tpueq"]
resource_name = "dive"
tracks/0/type = "value"
tracks/0/imported = false
tracks/0/enabled = true
tracks/0/path = NodePath(".:frame")
tracks/0/interp = 1
tracks/0/loop_wrap = true
tracks/0/keys = {
"times": PackedFloat32Array(0),
"transitions": PackedFloat32Array(1),
"update": 1,
"values": [7]
}

[sub_resource type="Animation" id="Animation_7x80f"]
resource_name = "dive_recover"
length = 0.1
tracks/0/type = "value"
tracks/0/imported = false
tracks/0/enabled = true
tracks/0/path = NodePath(".:frame")
tracks/0/interp = 1
tracks/0/loop_wrap = true
tracks/0/keys = {
"times": PackedFloat32Array(0),
"transitions": PackedFloat32Array(1),
"update": 1,
"values": [1]
}

[sub_resource type="Animation" id="Animation_n88fs"]
resource_name = "fall"
tracks/0/type = "value"
tracks/0/imported = false
tracks/0/enabled = true
tracks/0/path = NodePath(".:frame")
tracks/0/interp = 1
tracks/0/loop_wrap = true
tracks/0/keys = {
"times": PackedFloat32Array(0),
"transitions": PackedFloat32Array(1),
"update": 1,
"values": [2]
}

[sub_resource type="Animation" id="Animation_pqyin"]
resource_name = "idle"
tracks/0/type = "value"
tracks/0/imported = false
tracks/0/enabled = true
tracks/0/path = NodePath(".:frame")
tracks/0/interp = 1
tracks/0/loop_wrap = true
tracks/0/keys = {
"times": PackedFloat32Array(0),
"transitions": PackedFloat32Array(1),
"update": 1,
"values": [0]
}

[sub_resource type="Animation" id="Animation_e2c0i"]
resource_name = "run"
length = 0.666
loop_mode = 1
tracks/0/type = "value"
tracks/0/imported = false
tracks/0/enabled = true
tracks/0/path = NodePath(".:frame")
tracks/0/interp = 1
tracks/0/loop_wrap = true
tracks/0/keys = {
"times": PackedFloat32Array(0, 0.166, 0.333, 0.5),
"transitions": PackedFloat32Array(1, 1, 1, 1),
"update": 1,
"values": [5, 4, 5, 6]
}

[sub_resource type="Animation" id="Animation_kcas5"]
resource_name = "splat_h"
length = 0.1
tracks/0/type = "value"
tracks/0/imported = false
tracks/0/enabled = true
tracks/0/path = NodePath(".:frame")
tracks/0/interp = 1
tracks/0/loop_wrap = true
tracks/0/keys = {
"times": PackedFloat32Array(0),
"transitions": PackedFloat32Array(1),
"update": 1,
"values": [3]
}

[sub_resource type="Animation" id="Animation_ku51p"]
resource_name = "splat_v"
length = 0.1
tracks/0/type = "value"
tracks/0/imported = false
tracks/0/enabled = true
tracks/0/path = NodePath(".:frame")
tracks/0/interp = 1
tracks/0/loop_wrap = true
tracks/0/keys = {
"times": PackedFloat32Array(0),
"transitions": PackedFloat32Array(1),
"update": 1,
"values": [1]
}

[sub_resource type="AnimationLibrary" id="AnimationLibrary_khwd1"]
_data = {
"crouch": SubResource("Animation_2auoa"),
"dive": SubResource("Animation_tpueq"),
"dive_recover": SubResource("Animation_7x80f"),
"fall": SubResource("Animation_n88fs"),
"idle": SubResource("Animation_pqyin"),
"run": SubResource("Animation_e2c0i"),
"splat_h": SubResource("Animation_kcas5"),
"splat_v": SubResource("Animation_ku51p")
}

[sub_resource type="AnimationNodeAnimation" id="AnimationNodeAnimation_3a304"]
animation = &"crouch"

[sub_resource type="AnimationNodeAnimation" id="AnimationNodeAnimation_1jsbt"]
animation = &"dive"

[sub_resource type="AnimationNodeAnimation" id="AnimationNodeAnimation_tk7gr"]
animation = &"dive_recover"

[sub_resource type="AnimationNodeAnimation" id="AnimationNodeAnimation_10tnt"]
animation = &"fall"

[sub_resource type="AnimationNodeAnimation" id="AnimationNodeAnimation_46gqb"]
animation = &"idle"

[sub_resource type="AnimationNodeAnimation" id="AnimationNodeAnimation_5uimq"]
animation = &"run"

[sub_resource type="AnimationNodeAnimation" id="AnimationNodeAnimation_fcn3l"]
animation = &"splat_h"

[sub_resource type="AnimationNodeAnimation" id="AnimationNodeAnimation_y08ii"]
animation = &"splat_v"

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_210rp"]
advance_mode = 2

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_ckyy8"]
advance_mode = 2
advance_expression = "is_falling"

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_50jkc"]
advance_mode = 2
advance_expression = "is_running"

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_mugij"]
advance_mode = 2
advance_expression = "!is_running"

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_b40bs"]
advance_mode = 2
advance_expression = "is_crouching"

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_dwbqj"]
advance_mode = 2
advance_expression = "is_crouching"

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_b5e45"]
advance_mode = 2
advance_expression = "!is_crouching"

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_vw4xf"]
advance_mode = 2
advance_expression = "is_diving"

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_gnncj"]
advance_mode = 2
advance_expression = "!is_diving && !is_dive_stunned"

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_3sdm4"]
switch_mode = 2
advance_mode = 2

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_xh1cy"]
advance_mode = 2
advance_expression = "!is_falling || is_splat_v"

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_v8hmn"]
priority = 2
switch_mode = 2
advance_mode = 2

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_q22ed"]
advance_mode = 2
advance_expression = "is_splat_h"

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_eiddi"]
advance_mode = 2
advance_expression = "is_splat_h"

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_evkc2"]
switch_mode = 2
advance_mode = 2

[sub_resource type="AnimationNodeStateMachine" id="AnimationNodeStateMachine_e4ug0"]
states/End/position = Vector2(753.333, 99.5876)
states/Start/position = Vector2(227, 99.0892)
states/crouch/node = SubResource("AnimationNodeAnimation_3a304")
states/crouch/position = Vector2(226.111, -11.9231)
states/dive/node = SubResource("AnimationNodeAnimation_1jsbt")
states/dive/position = Vector2(629.202, 100.626)
states/dive_recover/node = SubResource("AnimationNodeAnimation_tk7gr")
states/dive_recover/position = Vector2(491.01, 299.444)
states/fall/node = SubResource("AnimationNodeAnimation_10tnt")
states/fall/position = Vector2(490.333, 100)
states/idle/node = SubResource("AnimationNodeAnimation_46gqb")
states/idle/position = Vector2(359, 100)
states/run/node = SubResource("AnimationNodeAnimation_5uimq")
states/run/position = Vector2(360.037, -10.6007)
states/splat_h/node = SubResource("AnimationNodeAnimation_fcn3l")
states/splat_h/position = Vector2(491.129, -10.5295)
states/splat_v/node = SubResource("AnimationNodeAnimation_y08ii")
states/splat_v/position = Vector2(489.867, 191.63)
transitions = ["Start", "idle", SubResource("AnimationNodeStateMachineTransition_210rp"), "idle", "fall", SubResource("AnimationNodeStateMachineTransition_ckyy8"), "idle", "run", SubResource("AnimationNodeStateMachineTransition_50jkc"), "run", "idle", SubResource("AnimationNodeStateMachineTransition_mugij"), "idle", "crouch", SubResource("AnimationNodeStateMachineTransition_b40bs"), "run", "crouch", SubResource("AnimationNodeStateMachineTransition_dwbqj"), "crouch", "idle", SubResource("AnimationNodeStateMachineTransition_b5e45"), "fall", "dive", SubResource("AnimationNodeStateMachineTransition_vw4xf"), "dive", "dive_recover", SubResource("AnimationNodeStateMachineTransition_gnncj"), "dive_recover", "idle", SubResource("AnimationNodeStateMachineTransition_3sdm4"), "fall", "splat_v", SubResource("AnimationNodeStateMachineTransition_xh1cy"), "splat_v", "idle", SubResource("AnimationNodeStateMachineTransition_v8hmn"), "fall", "splat_h", SubResource("AnimationNodeStateMachineTransition_q22ed"), "run", "splat_h", SubResource("AnimationNodeStateMachineTransition_eiddi"), "splat_h", "idle", SubResource("AnimationNodeStateMachineTransition_evkc2")]
graph_offset = Vector2(-345.518, -192.669)

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_t5kxn"]
advance_mode = 2

[sub_resource type="AnimationNodeStateMachine" id="AnimationNodeStateMachine_lk4fg"]
states/End/position = Vector2(656, 128)
states/Start/position = Vector2(347, 128)
states/small/node = SubResource("AnimationNodeStateMachine_e4ug0")
states/small/position = Vector2(503.769, 127.704)
transitions = ["Start", "small", SubResource("AnimationNodeStateMachineTransition_t5kxn")]
graph_offset = Vector2(-417.231, 21)

[node name="green_greens" type="Node"]

[node name="sim" type="Sim" parent="."]
player_accel = Vector2(5, 100)
player_vel_min = Vector2(-70, -175)
player_vel_max = Vector2(70, 120)
player_vel_damp_x = 2.0
player_jump_release_vel_y = -70.0
player_gravity = 6.0
player_gravity_dive_stunned = 15.0
player_max_jump_timer = 0.2
player_fall_dive_timer = 0.7
player_dive_bounce_vel_y = -175.0

[node name="map" type="TileMap" parent="."]
tile_set = ExtResource("2_ytr8y")
format = 2
layer_0/name = "base"
layer_0/navigation_enabled = false
layer_0/tile_data = PackedInt32Array(0, 0, 0, 1, 0, 0, 2, 0, 0, 3, 0, 0, 4, 0, 0, 65536, 0, 0, 65537, 0, 0, 65538, 0, 0, 65539, 0, 0, 65540, 0, 0, 131072, 0, 0, 131073, 0, 0, 131074, 0, 0, 131075, 0, 0, 131076, 0, 0, 196608, 0, 0, 196609, 0, 0, 196610, 0, 0, 196611, 0, 0, 196612, 0, 0, 262144, 0, 0, 262145, 0, 0, 262146, 0, 0, 262147, 0, 0, 262148, 0, 0, 196613, 0, 0, 196614, 0, 0, 196615, 0, 0, 131079, 0, 0, 65543, 0, 0, 7, 0, 0, 5, 0, 0, 6, 0, 0, 65542, 0, 0, 65541, 0, 0, 131077, 0, 0, 131078, 0, 0, 262149, 0, 0, 262150, 0, 0, 262151, 0, 0, 262152, 0, 0, 196616, 0, 0, 131080, 0, 0, 65544, 0, 0, 8, 0, 0, 327680, 0, 0, 393216, 0, 0, 458752, 0, 0, 524288, 0, 0, 524289, 0, 0, 524290, 0, 0, 524291, 0, 0, 524292, 0, 0, 524293, 0, 0, 524294, 0, 0, 524295, 0, 0, 524296, 0, 0, 524297, 0, 0, 458761, 0, 0, 393225, 0, 0, 327689, 0, 0, 262153, 0, 0, 196617, 0, 0, 131081, 0, 0, 65545, 0, 0, 9, 0, 0, 327688, 0, 0, 327687, 0, 0, 327686, 0, 0, 327685, 0, 0, 327684, 0, 0, 327683, 0, 0, 327682, 0, 0, 327681, 0, 0, 393217, 0, 0, 393218, 0, 0, 393219, 0, 0, 393220, 0, 0, 393221, 0, 0, 393222, 0, 0, 393223, 0, 0, 393224, 0, 0, 458760, 0, 0, 458759, 0, 0, 458758, 0, 0, 458757, 0, 0, 458756, 0, 0, 458755, 0, 0, 458754, 0, 0, 458753, 0, 0)
layer_1/name = "collision"
layer_1/enabled = true
layer_1/modulate = Color(1, 1, 1, 1)
layer_1/y_sort_enabled = false
layer_1/y_sort_origin = 0
layer_1/z_index = 0
layer_1/navigation_enabled = false
layer_1/tile_data = PackedInt32Array(393216, 65536, 0, 393217, 65536, 0, 393218, 65536, 0, 393219, 65536, 0, 393220, 65536, 0, 393221, 65536, 0, 393222, 65536, 0, 393224, 65536, 0, 393225, 65536, 0, 327686, 65536, 0, 393223, 65536, 0, 262150, 65536, 0, 327685, 65536, 0, 327687, 65536, 0, 262151, 65536, 0, 196615, 65536, 0)

[node name="player" type="Player" parent="."]
sim = NodePath("../sim")
anim_tree = NodePath("anim_tree")
small_star = NodePath("small_star")
run_anim_vel = 0.1
splat_h_vel = 1.0
position = Vector2(32, 48)
texture = ExtResource("2_1rp8d")
centered = false
hframes = 4
vframes = 2

[node name="anim_tree" type="AnimationTree" parent="player"]
libraries = {
"": SubResource("AnimationLibrary_khwd1")
}
tree_root = SubResource("AnimationNodeStateMachine_lk4fg")
advance_expression_base_node = NodePath("..")
anim_player = NodePath("../anim_player")

[node name="anim_player" type="AnimationPlayer" parent="player"]
libraries = {
"": SubResource("AnimationLibrary_khwd1")
}

[node name="small_star" type="CPUParticles2D" parent="player"]
position = Vector2(8, 8)
emitting = false
amount = 1
lifetime = 0.4
one_shot = true
texture = ExtResource("3_p0u2b")
emission_shape = 5
emission_points = PackedVector2Array(8, 0, -8, 0, 0, 8, 0, -8, 5.65, -5.65, 5.65, 5.65, -5.65, -5.65, -5.65, 5.65)
emission_normals = PackedVector2Array(1, 0, -1, 0, 0, 1, 0, -1, 0.707, -0.707, 0.707, 0.707, -0.707, -0.707, -0.707, 0.707)
emission_colors = PackedColorArray()
spread = 0.0
gravity = Vector2(0, 0)
initial_velocity_min = 300.0
initial_velocity_max = 300.0
damping_min = 4000.0
damping_max = 4000.0
